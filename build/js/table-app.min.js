/*! table-app 2015-07-10 */
var mio=mio||{};mio.modules={},mio.requiredModules=["tableGenerator","clicker"],mio.isRequired=function(a){for(var b=0;b<mio.requiredModules.length;b++)if(a===mio.requiredModules[b])return!0};var mio=mio||{};mio.data=function(){"use strict";var a={},b=[{fullName:"John Doe",jobTitle:"UI Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/05/2025",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}},{fullName:"John Doe",jobTitle:"UI Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/05/2015",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}},{fullName:"Ciba Mumu",jobTitle:"UI Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/055/2015",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}},{fullName:"John Doe",jobTitle:"UI Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/05/2015",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}},{fullName:"Carmen Budau",jobTitle:"UI Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/05/2015",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}},{fullName:"Ciba Mumu",jobTitle:"UI Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/05/2015",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}},{fullName:"John Doe",jobTitle:"UI Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/05/2015",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}},{fullName:"Bogdan Volosincu",jobTitle:"UI Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/05/2015",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}},{fullName:"Carmen Budau",jobTitle:"UI Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/05/2015",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}},{fullName:"Vrinceanu Valentin",jobTitle:"UI Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/05/2015",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2018","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}}],c=[{fullName:"Vrinceanu Valentin",jobTitle:"Java Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/05/2015",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}},{fullName:"Bogdan Volosincu",jobTitle:".NET Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/05/2015",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}},{fullName:"Carmen Budau",jobTitle:"UI Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/05/2015",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}},{fullName:"Ciba Mumu",jobTitle:"UI Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/05/2015",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}},{fullName:"Vrinceanu Valentin",jobTitle:"UI Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/06/2015",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}},{fullName:"Bogdan Volosincu",jobTitle:"UI Developer",grade:"Senior Engineer",allocationStatus:"Allocated",project:"Trinity Mirror",dateOfBooking:"10/05/2016",details:{"Delivery Unit":"ISD_Iasi","Date of Start":"12/03/2015","Line manager":"Bogdan Volosincu","Project Manager":"Andrei Ursache"}}];return a.employees=b,a.customers=c,a}();var mio=mio||{};mio.modules.tableGenerator=function(a){"use strict";var b=function(b){var c=a.querySelector(b)||a.querySelector(".data-tbl"),d=c.querySelector(".table__content-wrapper"),e=this.getDataSource(c),f=mio.data[e],g=this.getTblHeaderInfo(c);this.generateData(f,g,d),this.resizeColumns(g,c),d.addEventListener("click",this.toolboxClickHandler.bind(this))};return b.prototype.getDataSource=function(a){var b=a.getAttribute("data-source");return b?b:"employees"},b.prototype.resizeColumns=function(a,b){var c,d,e;for(c=Object.keys(a).length,d=b.querySelectorAll(".tbl-row__header li, .data-tbl__header li"),e=0;e<d.length;e+=1)d[e].style.width=100/c+"%"},b.prototype.createDomElement=function(b){var c,d;if(c=a.createElement(b.elementType),d="string"==typeof b.parentSelectorName?a.querySelectorAll(b.parentSelectorName):b.parentSelectorName,b.elementClassList)if(b.elementClassList.constructor===Array)for(var e in b.elementClassList)c.classList.contains(b.elementClassList[e])||c.classList.add(b.elementClassList[e]);else c.classList.add(b.elementClassList);if(b.elementAttribute)for(var f in b.elementAttribute)b.elementAttribute[f].hasOwnProperty&&c.setAttribute(b.elementAttribute[f].name,b.elementAttribute[f].value);if(b.elementValue&&("input"===b.elementType?c.value=b.elementValue:c.innerHTML=b.elementValue),!d)return c;if(d.length>1)for(var g=0;g<d.length;g+=1)d[g].appendChild(c);else d.appendChild(c);return!1},b.prototype.createColumn=function(a,b,c){var d,e=a,f=this.createDomElement({elementType:"li",elementAttribute:[{name:"data-editable",value:""},{name:"data-row",value:b},{name:"data-column",value:c}]});return d=this.createDomElement({elementType:"input",elementValue:e[c],elementClassList:"editable-input",elementAttribute:[{name:"type",value:"text"}]}),f.appendChild(d),f},b.prototype.createRow=function(a,b,c,d){var e=this,f=e.createDomElement({elementType:"div",elementClassList:"data-tbl__row"}),g=e.createDomElement({elementType:"ul",elementClassList:["tbl-row__header","clearfix"]});for(var h in b)b.hasOwnProperty(h)&&g.appendChild(e.createColumn(a,d,h));e.createToolbox(g.lastChild,d),f.appendChild(g),c.appendChild(f)},b.prototype.generateData=function(a,b,c){var d=this;a.filter(function(a,e){d.createRow(a,b,c,e)})},b.prototype.getTblHeaderInfo=function(a){for(var b=a.querySelector(".data-tbl__header ul"),c={},d=0;d<b.children.length;d++)c[b.children[d].getAttribute("data-description")]=d;return c},b.prototype.findParent=function(a,b){for(;(a=a.parentElement)&&!a.classList.contains(b););return a},b.prototype.createToolbox=function(a,b){var c,d='<span class = "toolbox__delete" data-row = '+b+'></span><span class="toolbox__arrow toolbox__arrow--closed"></span>';c=this.createDomElement({elementType:"div",elementClassList:"toolbox__controlls",elementValue:d,parentSelectorName:a}),a.classList.add("toolbox")},b.prototype.toolboxClickHandler=function(a,b){if(a.target.classList.contains("toolbox__arrow")){var c=this.findParent(a.target,"data-tbl__row"),d=c.children[1];this.toggleRowDetails(d,a.target),a.stopPropagation()}},b.prototype.toggleRowDetails=function(a,b){b.classList.contains("toolbox__arrow--closed")?(b.classList.remove("toolbox__arrow--closed"),b.classList.add("toolbox__arrow--open"),a.classList.remove("closed"),a.classList.add("open")):(b.classList.add("toolbox__arrow--closed"),b.classList.remove("toolbox__arrow--open"),a.classList.add("closed"),a.classList.remove("open"))},b}(window.document);var mio=mio||{};mio.modules.persistence=function(a,b,c){"use strict";function d(a,c){b.setItem(a,JSON.stringify(c))}function e(e){var f,g=a.querySelector(e).getAttribute("data-source")||"employees",h=b.getItem(g),i=[];if(this.source=g,h){f=JSON.parse(h);for(var j=0;j<f.length;j++)""!=f[j]&&i.push(f[j]);c.log(i),mio.data[g]=i}else d(g,mio.data[g])}function f(a){mio.data[this.source].push(a),c.log(mio.data[this.source]),d(this.source,mio.data[this.source])}function g(a){}function h(a,b){d(a,b)}return{init:e,add:f,remove:g,update:h}}(window.document,window.localStorage,window.console);var mio=mio||{};mio.modules.search=function(){"use strict";var a={},b=function(b,c){b in a||(a[b]=[]),a[b].push(c)},c=function(b,c,d,e,f){for(var g=0;g<a[b].length;g++)a[b][g].call(f,c,d,e)};return{addEvListener:b,trigger:c}}(),function(a,b){"use strict";function c(a,b,c){for(var d=(b.headerInfo[c],b.tableRoot.querySelectorAll(".data-tbl__row")),e=0;e<b.tableData.length;e++)-1!==b.tableData[e][c].toLowerCase().indexOf(a.toLowerCase())?d[e].style.display="block":d[e].style.display="none"}function d(c,d,e){var f=b.createElement("div");f.className="data-tbl__row";var g=b.createElement("ul");g.className="tbl-row__header",g.classList.add("clearfix");var h=Object.keys(d).length;for(var i in d){var j=b.createElement("li"),k=b.createElement("input");j.setAttribute("data-editable",""),j.setAttribute("data-row",a.tableInstances[0].tableData.length-1),j.setAttribute("data-column",i),j.style.width=100/h+"%",k.type="text",k.placeholder="Add data",k.className="editable-input",j.appendChild(k),g.appendChild(j)}f.appendChild(g),e.appendChild(f)}function e(b){var c=b.target.parentElement,d=c.getAttribute("data-row"),e=c.getAttribute("data-column"),f=b.target.value;a.data[a.modules.persistence.source][d][e]=f,a.modules.persistence.update(a.modules.persistence.source,a.data[a.modules.persistence.source])}function f(b){return function(){var c=o[b].parentElement,d=c.parentElement.getAttribute("data-row");a.data[a.modules.persistence.source][d]="",c.parentElement.parentElement.parentElement.style.display="none",a.modules.persistence.update(a.modules.persistence.source,a.data[a.modules.persistence.source]),console.log(a.data[a.modules.persistence.source])}}function g(a,b){var c={};c.exists=!1;for(var d=0;d<a.length;d++)for(var e in b.headerInfo){var f=b.dataTable.querySelectorAll(".data-tbl__header li");if(-1!=e.toLowerCase().indexOf(a[d])){var g=b.headerInfo[e];f[g].classList.add("column-found"),c.exists=!0,c.column=e}else f[b.headerInfo[e]].classList.remove("column-found")}return c}function h(a){var b=a.target,c=b.parentElement.getElementsByTagName("ul")[0];b.classList.contains("nav__hamburger--offset")?(b.classList.remove("nav__hamburger--offset"),c.classList.remove("visible-menu")):(b.classList.add("nav__hamburger--offset"),c.classList.add("visible-menu"))}function i(a){var c=b.querySelector(".error"),d=b.querySelector(".error__body");c.style.display="block",d.textContent=a,setTimeout(function(){c.style.display="none"},3500)}function j(a){for(var b=a.replace(/[&\\#,@+()$~%.!_|'":*?\^<>{}]/g,"").replace(/  +/g," ").split(" "),c=0;c<b.length;c++)b[c]=b[c].toLowerCase(),b[c].length<2&&b.splice(c,1);return 0===b.length?(i("validation error"),!1):b}function k(b){var c=j(b.target.value);if(c){if(g(c,a.tableInstances[0]))return g(c,a.tableInstances[0]).column;i("key not found in table header")}else i("validation error");return!1}function l(){s.style.display="block"}function m(){setTimeout(function(){s.style.display="none"},2500)}var n,o,a=a||{},p=b.querySelector(".table-filter"),q=b.querySelector(".table-filter--editable"),r=b.querySelector(".hamburger__icon"),s=b.querySelector(".loading"),t=b.querySelector(".btn--add-record");a.config={},a.tableInstances=[],a.modules.persistence.init(".editable-table"),a.tableInstances.push(new a.modules.tableGenerator(".editable-table",{editable:!0})),n=b.querySelectorAll("[data-editable] > input"),o=b.querySelectorAll(".toolbox__delete"),a.modules.search.addEvListener("firstSearchEvent",c),a.modules.search.addEvListener("secondSearchEvent",c),r.addEventListener("click",h),p.addEventListener("keyup",function(b){if("search-field"==b.target.className){var c=b.target.value;a.modules.search.trigger("firstSearchEvent",c,a.tableInstances[0],"fullName",this)}}),q.addEventListener("submit",function(a){a.preventDefault()}),q.addEventListener("keydown",function(b){if("search-field--editable"==b.target.className&&(186===b.keyCode&&(a.modules.search.column=k(b)),13===b.keyCode))if(a.modules.search.column){var c=b.target.value.substring(b.target.value.indexOf(":"));c=j(c),console.log(c),c?(l(),m(),a.modules.search.trigger("secondSearchEvent",c[0],a.tableInstances[0],a.modules.search.column,this)):(i("Query incorrect or no records found."),a.modules.search.trigger("secondSearchEvent","",a.tableInstances[0],a.modules.search.column,this))}else i("An error has occurred, please try again and make sure your query is correct.")}),t.addEventListener("click",function(){var c=b.querySelector(".editable-table .table__content-wrapper"),e={allocationStatus:"Add data",dateOfBooking:"10/05/2025",details:{"Date of Start":"12/03/2015","Delivery Unit":"Add data","Line manager":"Add data","Project Manager":"Add data"},fullName:"Add data",grade:"Add data",jobTitle:"Add data",project:"Add data"};a.modules.persistence.add(e),d(e,a.tableInstances[0].headerInfo,c)}),b.querySelector("body").addEventListener("keyup",function(a){a.target.classList.contains("editable-input")&&e(a)});for(var u=0;u<o.length;u++)o[u].addEventListener("click",f(u))}(mio,document);